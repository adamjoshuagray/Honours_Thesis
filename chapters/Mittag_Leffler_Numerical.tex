\section{Numerical Evaluation of Special Functions}

In this section we cover the numerical evaluation of the Mittag-Leffler function and the Wright function
which as seen in other sections of this thesis, are functions which commonly arise when dealing with
fractional differential equations.

Even if an analytic solution to an initial value problem, or a boundary value problem is known, actually
evaluating values of the functions involved in the function is not trivial. Despite the fact that both
the Mittag-Leffler function and the Wright function are defined in terms of series, these series do not 
converge at a satisfactory rate. [NEED REF] Also these series involve gamma functions which in themselves
have a number of numerical difficulties, at least in so much as it is not quite as clear how to evaluate 
a gamma function as it is a factorial. We discuss the evaluation of the gamma function in section \ref{sec:num-gamma}.


\subsection{Mittag-Lefller Function}
\subsubsection{Integral Representation of $ E_{\alpha,\beta}(z) $}

We firstly need to develop a contour integral representation of $ \Gamma(z) $ and of $ \frac{1}{\Gamma(z)} $.
The gamma function is defined as
\begin{align}
    \Gamma(z) = \int_0^\infty e^t t^{z-1} dt
\end{align}
where integration is done with a real valued $ t $. The idea here is to \emph{lift} this integral into
complex plane an then integrate along the contour shown in figure \ref{fig:Hankel_Loop_2}. We formalize 
this idea in the following lemma.

\begin{lemma}
    \label{lem:contour_gamma}
    A contour integral representation of $ \Gamma(z) $ is given by
    \begin{align}
        \Gamma(z) = \frac{1}{e^{2 \pi i z} - 1} \int_{C} e^{-t}d^{z-1} dt
    \end{align}
where $ C $ is the contour depicted in figure \ref{fig:Hankel_Loop_2}.
\end{lemma}
This proof follows that of Podlubny \cite{Podlubny1999}.
\begin{proof}
Consider the contour integral
\begin{align*}
    \int_C e^{(z-1)\log(t) - t} dt.
\end{align*}
Due to the fact that the integrand involves a $ \log $ function it is multivalued unless we specify a branch
cut. We will adopt a branch cut along the non-negative real axis. As long as $ \varepsilon $ 
is chosen sufficiently small ($ \varepsilon < 1 $) then Cauchy's theorem guarentees that this contour 
integral has the same value for all choices of $ \varepsilon > 0 $ because the integrand has only one
singularity at $ t = 0 $.

Now consider the contour in three pieces, $ C_{\varepsilon} $, the circle of radius $ \varepsilon $ 
centered at 0, $ (\varepsilon, \infty) $, the bottom half of the contour and $ (\infty, \varepsilon) $, 
the top half of the contour. 

As $ \varepsilon $ can be made arbitarily small we take both straight parts of the contour to be
real but on the lower half of the contour we must replace $ \log(t) $ with $ \log(t) + 2\pi i $. 

This results in 
\begin{align*}
    \int_C e^{(z-1)\log(t)-t} dt &= \int_\infty^\varepsilon e^{(z-1)\log(t) - t} dt + \int_{C_\varepsilon} 
        e^{(z-1)log(t) - t} dt + \int_{\varepsilon, \infty} e^{(z-1)\log(t) - t + 2\pi i} dt \\
    &= \int_\infty^\varepsilon e^{-t}t^{z-1}dt + \int_{C_\varepsilon} e^{-t}t^{z-1}dt +
    e^{2(z-1)\pi i} \int_\varepsilon^\infty e^{-t}t^{z-1} dt
\end{align*}

\begin{wrapfigure}{l}{210pt}
    \input{diagrams/Hankel_Loop_2.tex}
    \caption{The Hankel contour C}
    \label{fig:Hankel_Loop_2}
\end{wrapfigure}

It can be shown by simple application of the ML lemma, as in \cite{Podlubny1999}, that the integral along
$ C_\varepsilon $ goes to zero as $ \varepsilon \lra 0 $.

Taking $ \varepsilon \lra 0 $ in the other two integrals and rearanging gives us the result
\begin{align}
    \label{eq:gamma_contour}
    \int_0^\infty e^{-t} t^{z-1} dt = \frac{1}{e^{2 \pi i z} - 1} \int_c e^{-t}t^{x-1} dt
\end{align}
\end{proof}

We would like to exploit this result to give a simple contour integral representation of $ \frac{1}{\Gamma(z)} $.

\begin{lemma}
    A contour integral representation of $ \frac{1}{\Gamma(z)} $ is given by
    \begin{align*}
        \frac{1}{\Gamma(z)} = \frac{1}{2 \pi i} \int_{Ha} e^\tau \tau^{-z} d\tau
    \end{align*}
    where the contour $ Ha $ is shown in figure \ref{fig:hankel_loop}.
\end{lemma}
This proof follows that of Podlubny \cite{Podlubny1999}
\begin{proof}
    By taking the result of \ref{lem:contour_gamma} and substituting $ z-1 $ in \eqref{eq:gamma_contour}
    we get that
    \begin{align*}
        \int_C e^{-t} t^{-z} dt = (e^{-2 \pi i z} -1) \Gamma(1-z).
    \end{align*}
    Performing the substitution $ \tau = -t $ rotates the contour integral clockwise $ 180 $ degrees 
    and results in 
    \begin{align*}
        \int_{C} e^{-t} t^{-z} dt = - e^{-z\pi i}\int_{Ha} e^{\tau} \tau^{-z} d\tau
    \end{align*}
    and so
    \begin{align*}
        \Gamma(1-z) &= \frac{1}{e^{z\pi i} - e^{-z \pi i}} \int_{Ha} e^\tau \tau^{-z} d\tau \\
            &= \frac{1}{2i \sin(\pi z)}\int_{Ha} e^\tau \tau^{-z} d\tau.
    \end{align*}
    Now taking into account the well known Euler reflection formula, $ \Gamma(z)\Gamma(1-z) = \frac{\pi}{\sin(\pi z)} $, we get
    \begin{align*}
        \frac{1}{\Gamma(z)} = \frac{1}{2 \pi i} \int_{Ha} e^\tau \tau^{-z} d\tau.
    \end{align*} \qed
    \begin{wrapfigure}{r}{210pt}
        \input{diagrams/Hankel_Loop.tex}
        \caption{The Hankel contour Ha}
        \label{fig:hankel_loop}
    \end{wrapfigure}
\end{proof}

We now wish to give a pair of contour integral representations of the function $ \frac{1}{\Gamma(z)} $
which we will then use in a pair of contour integrals representing $ E_{\alpha, \beta}(z) $. 

\begin{lemma}
    The function $ \frac{1}{\Gamma(z)} $ can be represented by the following contour integrals
    \begin{align}
        \frac{1}{\Gamma(z)} = \frac{1}{2 \pi \alpha i} \int_{\gamma(\varepsilon, \mu)} 
                              e^{\zeta^{1 / \alpha}} \zeta^{(1-z-\alpha) / \alpha} d\zeta 
    \end{align}
    where
    \begin{align}
        \left( \alpha < 2, \frac{\pi \alpha}{2} < \mu < \min\{ \pi, \pi \alpha \} \right)
    \end{align}
    or where $ Re(z) > 0 $
    \begin{align}
        \frac{1}{\Gamma(z)} = \frac{1}{4 \pi i} \int_{\gamma(\varepsilon, \pi)} e^{\zeta^{1 / 2}} \zeta^{-(z + 1) / 2} d\zeta
    \end{align}
    where the contours $ \gamma(\varepsilon, \varphi) $ are depicted in figure \ref{fig:hankel_wedge}.
\end{lemma}
This proof follows that of Podlubny \cite{Podlubny1999}.
\begin{proof}

\begin{wrapfigure}{l}{210pt}
    \input{diagrams/Hankel_Wedge.tex}
    \caption{The Hankel countour $ \gamma(\varepsilon, \varphi) $}
    \label{fig:hankel_wedge}
\end{wrapfigure}
\end{proof}

\begin{wrapfigure}{l}{210pt}
    \input{diagrams/Hankel_Wedge_2.tex}
    \caption{ Integration contour for $ \gamma(\varepsilon, \varphi) $}
    \label{fig:hankel_wedge}
\end{wrapfigure}
\end{proof}

\subsection{Additional Notes on the Numerical Evaluation of the Gamma Function}
\label{sec:num-gamma}
These notes are included because the numerical evaluation of the gamma function is important regardless of
whether it is actually used in the above methods for evaluation of the Mittag-Leffler and Wright functions.
For example the Lanczos approximation is used in the scheme outlined in [INSERT CC REF] and implemented 
in code available in Appendix A.

\subsubsection{Stirling's Approximation}

\subsubsection{Lanczos Approximation}

\subsubsection{Spouge Approximation}
The Spouge approximation, like teh Lanczos approximation 

\clearpage
